name: Validate Supabase Secrets

on:
  push:
    branches: [ main ]

jobs:
  check-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Check required secrets
        env:
          REACT_APP_SUPABASE_URL: ${{ secrets.REACT_APP_SUPABASE_URL }}
          REACT_APP_SUPABASE_ANON_KEY: ${{ secrets.REACT_APP_SUPABASE_ANON_KEY }}
          SUPABASE_SERVICE_ROLE_KEY: ${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}
        run: |
          missing=0
          if [ -z "$REACT_APP_SUPABASE_URL" ]; then echo "REACT_APP_SUPABASE_URL is missing"; missing=1; fi
          if [ -z "$REACT_APP_SUPABASE_ANON_KEY" ]; then echo "REACT_APP_SUPABASE_ANON_KEY is missing"; missing=1; fi
          if [ -z "$SUPABASE_SERVICE_ROLE_KEY" ]; then echo "SUPABASE_SERVICE_ROLE_KEY is missing (server-only)"; fi
          if [ "$missing" -eq 1 ]; then echo "One or more required secrets are missing"; exit 1; fi
